"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[872],{7872:function(e,t,a){a.r(t),a.d(t,{default:function(){return AdminNotifications}});var r=a(5893),s=a(7294),n=a(9185),i=a(169);function AdminNotifications(){let[e,t]=(0,s.useState)([]),[a,o]=(0,s.useState)(!1),[l,c]=(0,s.useState)(null),[d,u]=(0,s.useState)(!1);(0,s.useEffect)(()=>{let e=(0,i.PR)();e&&(0,i.GJ)()&&initializeNotifications()},[]);let initializeNotifications=async()=>{try{let e=localStorage.getItem("lastNotificationCheck"),t=Date.now();e?c(parseInt(e)):(c(t),localStorage.setItem("lastNotificationCheck",t.toString())),u(!0);let a=setInterval(checkForNewOrders,3e4);return()=>clearInterval(a)}catch(e){console.error("Error initializing notifications:",e)}},checkForNewOrders=async()=>{try{let e=(0,i.PR)();if(!e||!(0,i.GJ)()||!d||!l)return;let a=await n.A6.getAllAdmin(),r=a.data.filter(e=>new Date(e.created_at).getTime()>l);if(r.length>0){let e=r.map(e=>({id:e.id,message:"New order #".concat(e.id," from ").concat(e.user_name),amount:e.total_amount,timestamp:new Date(e.created_at)}));t(t=>[...e,...t].slice(0,10));let a=Date.now();c(a),localStorage.setItem("lastNotificationCheck",a.toString())}}catch(e){console.error("Error checking for new orders:",e)}};return(0,r.jsxs)("div",{className:"relative",children:[(0,r.jsxs)("button",{onClick:()=>o(!a),className:"relative p-2 text-gray-600 hover:text-gray-900 focus:outline-none",children:["\uD83D\uDD14",e.length>0&&(0,r.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full h-5 w-5 flex items-center justify-center animate-pulse",children:e.length})]}),a&&(0,r.jsxs)("div",{className:"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-xl border z-50",children:[(0,r.jsx)("div",{className:"p-4 border-b",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("h3",{className:"font-semibold text-gray-900",children:"\uD83D\uDD14 Notifications"}),e.length>0&&(0,r.jsx)("button",{onClick:()=>{t([]),o(!1)},className:"text-sm text-blue-600 hover:text-blue-800",children:"Clear all"})]})}),(0,r.jsx)("div",{className:"max-h-64 overflow-y-auto",children:0===e.length?(0,r.jsxs)("div",{className:"p-4 text-center text-gray-500",children:[(0,r.jsx)("div",{className:"text-2xl mb-2",children:"\uD83D\uDD15"}),(0,r.jsx)("p",{children:"No new notifications"})]}):e.map(e=>(0,r.jsxs)("div",{className:"p-4 border-b hover:bg-gray-50",children:[(0,r.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.message}),(0,r.jsxs)("p",{className:"text-sm text-green-600 font-semibold",children:["\uD83D\uDCB0 $",parseFloat(e.amount).toFixed(2)]}),(0,r.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:e.timestamp.toLocaleTimeString()})]},e.id))})]})]})}},9185:function(e,t,a){a.d(t,{A6:function(){return o},I8:function(){return n},RB:function(){return i}});var r=a(7066);let s=r.Z.create({baseURL:"https://clothstore-98w2.onrender.com/api"});s.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e});let n={login:e=>s.post("/auth/login",e),register:e=>s.post("/auth/register",e)},i={getAll:()=>s.get("/products"),getById:e=>s.get("/products/".concat(e)),create:e=>s.post("/products",e,{headers:{"Content-Type":"multipart/form-data"}}),update:(e,t)=>s.put("/products/".concat(e),t,{headers:{"Content-Type":"multipart/form-data"}}),delete:e=>s.delete("/products/".concat(e))},o={create:e=>s.post("/orders",e),getAll:()=>s.get("/orders"),getAllAdmin:()=>s.get("/orders/admin/all"),getRevenue:()=>s.get("/orders/admin/revenue"),updateStatus:(e,t)=>s.put("/orders/".concat(e,"/status"),{status:t}),cancel:e=>s.put("/orders/".concat(e,"/cancel"))}}}]);