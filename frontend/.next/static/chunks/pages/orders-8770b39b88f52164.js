(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[660],{9501:function(e,t,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/orders",function(){return r(6039)}])},6039:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return Orders}});var s=r(5893),a=r(7294),n=r(1163),l=r(1664),d=r.n(l),c=r(9185),i=r(169);function Orders(){let[e,t]=(0,a.useState)([]),[r,l]=(0,a.useState)(!0),[o,u]=(0,a.useState)(null),p=(0,n.useRouter)();(0,a.useEffect)(()=>{let e=(0,i.PR)();if(!e){p.push("/login");return}fetchOrders()},[]);let fetchOrders=async()=>{try{let e=await c.A6.getAll();t(e.data)}catch(e){console.error("Error fetching orders:",e)}finally{l(!1)}},handleCancelOrder=async e=>{if(confirm("Are you sure you want to cancel this order?")){u(e);try{await c.A6.cancel(e),fetchOrders()}catch(e){var t,r;alert((null===(r=e.response)||void 0===r?void 0:null===(t=r.data)||void 0===t?void 0:t.error)||"Failed to cancel order")}finally{u(null)}}},getStatusColor=e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"processing":return"bg-blue-100 text-blue-800";case"shipped":return"bg-purple-100 text-purple-800";case"delivered":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},canCancelOrder=e=>["pending","processing"].includes(e);return r?(0,s.jsxs)("div",{className:"flex items-center justify-center py-16",children:[(0,s.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"}),(0,s.jsx)("span",{className:"ml-3 text-lg text-gray-600",children:"Loading your orders..."})]}):(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"mb-8",children:[(0,s.jsx)("h1",{className:"text-4xl font-bold gradient-text mb-2",children:"\uD83D\uDCE6 My Orders"}),(0,s.jsx)("p",{className:"text-gray-600",children:"Track and manage your order history"})]}),0===e.length?(0,s.jsxs)("div",{className:"text-center py-16",children:[(0,s.jsx)("div",{className:"text-8xl mb-6",children:"\uD83D\uDCE6"}),(0,s.jsx)("h3",{className:"text-2xl font-bold text-gray-900 mb-4",children:"No Orders Yet"}),(0,s.jsx)("p",{className:"text-gray-600 mb-8",children:"You haven't placed any orders yet. Start shopping to see your orders here!"}),(0,s.jsx)(d(),{href:"/",className:"btn-primary inline-block",children:"\uD83D\uDECD️ Start Shopping"})]}):(0,s.jsx)("div",{className:"space-y-6",children:e.map(e=>(0,s.jsxs)("div",{className:"card p-6",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsxs)("h3",{className:"text-xl font-bold mb-2",children:["Order #",e.id]}),(0,s.jsxs)("p",{className:"text-gray-600 mb-1",children:["\uD83D\uDCC5 Placed on ",new Date(e.created_at).toLocaleDateString()]}),(0,s.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-sm font-semibold ".concat(getStatusColor(e.status)),children:e.status.toUpperCase()})]}),(0,s.jsxs)("div",{className:"text-right",children:[(0,s.jsxs)("p",{className:"text-2xl font-bold text-green-600 mb-3",children:["$",parseFloat(e.total_amount).toFixed(2)]}),canCancelOrder(e.status)&&(0,s.jsx)("button",{onClick:()=>handleCancelOrder(e.id),disabled:o===e.id,className:"bg-red-500 text-white px-4 py-2 rounded-lg hover:bg-red-600 disabled:opacity-50 transition-all duration-200",children:o===e.id?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("span",{className:"animate-spin mr-2",children:"⏳"}),"Cancelling..."]}):"❌ Cancel Order"})]})]}),(0,s.jsxs)("div",{className:"border-t pt-4 mb-4",children:[(0,s.jsx)("h4",{className:"font-semibold mb-3",children:"\uD83D\uDCCB Items:"}),(0,s.jsx)("div",{className:"space-y-2",children:e.items&&e.items.map((e,t)=>(0,s.jsxs)("div",{className:"flex justify-between items-center py-2 px-3 bg-gray-50 rounded-lg",children:[(0,s.jsx)("span",{className:"font-medium",children:e.name}),(0,s.jsxs)("span",{className:"text-gray-600",children:["Qty: ",e.quantity," \xd7 $",parseFloat(e.price).toFixed(2)]})]},t))})]}),e.shipping_address&&(0,s.jsxs)("div",{className:"border-t pt-4",children:[(0,s.jsx)("h4",{className:"font-semibold mb-2",children:"\uD83D\uDCCD Shipping Address:"}),(0,s.jsx)("p",{className:"text-gray-600 bg-gray-50 p-3 rounded-lg",children:e.shipping_address})]})]},e.id))})]})}},9185:function(e,t,r){"use strict";r.d(t,{A6:function(){return d},I8:function(){return n},RB:function(){return l}});var s=r(7066);let a=s.Z.create({baseURL:"https://clothstore-98w2.onrender.com/api"});a.interceptors.request.use(e=>{let t=localStorage.getItem("token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e});let n={login:e=>a.post("/auth/login",e),register:e=>a.post("/auth/register",e)},l={getAll:()=>a.get("/products"),getById:e=>a.get("/products/".concat(e)),create:e=>a.post("/products",e,{headers:{"Content-Type":"multipart/form-data"}}),update:(e,t)=>a.put("/products/".concat(e),t,{headers:{"Content-Type":"multipart/form-data"}}),delete:e=>a.delete("/products/".concat(e))},d={create:e=>a.post("/orders",e),getAll:()=>a.get("/orders"),getAllAdmin:()=>a.get("/orders/admin/all"),getRevenue:()=>a.get("/orders/admin/revenue"),updateStatus:(e,t)=>a.put("/orders/".concat(e,"/status"),{status:t}),cancel:e=>a.put("/orders/".concat(e,"/cancel"))}},1163:function(e,t,r){e.exports=r(9974)}},function(e){e.O(0,[66,774,888,179],function(){return e(e.s=9501)}),_N_E=e.O()}]);